import { useState } from 'react'
import { action } from '@storybook/addon-actions'
import {
  Select,
  SelectGroup,
  Form,
  Flex,
  Box,
  FormControl,
  FormHelperText,
  FormLabel,
  FormControlLabel,
  Input,
  OutlinedInput,
  InputLabel,
  MenuItem,
  makeStyles,
  Theme,
  createStyles
} from '../../../src'
import { Meta, Story, Preview, Props } from '@storybook/addon-docs/blocks'
import { SelectDocs } from './SelectDocs'

<Meta title="components|Select" component={Select} />

# Select

Extends [Material UI Select](https://material-ui.com/components/selects)

Selects can be used to choose from a list of more than two options.

With forms, generally it is easier to use a [`TextField`](/components/?path=/docs/components-text-field--default)
but examples below show raw use. The `TextField` will correctly handle the setting of the label width
for you. The first example shows how this is done, the others just ignore it.

<Preview>
  <Story name="default">
    {() => {
      const inputLabel = React.useRef(null)
      const [labelWidth, setLabelWidth] = React.useState(0)
      React.useEffect(() => {
        setLabelWidth(inputLabel.current.offsetWidth)
      }, [])
      return (
        <FormControl m={2} minWidth={300}>
          <InputLabel ref={inputLabel} htmlFor="age-simple">
            Age
          </InputLabel>
          <Select
            labelWidth={labelWidth}
            onChange={action('change')}
            inputProps={{ name: 'age', id: 'age-simple' }}
          >
            <MenuItem value={10}>Ten</MenuItem>
            <MenuItem value={20}>Twenty</MenuItem>
            <MenuItem value={30}>Thirty</MenuItem>
          </Select>
        </FormControl>
      )
    }}
  </Story>
  <Story name="with helper">
    <FormControl m={2} minWidth={300}>
      <InputLabel htmlFor="age-helper">Age</InputLabel>
      <Select
        onChange={action('change')}
        input={<OutlinedInput name="age" id="age-helper" />}
      >
        <MenuItem value="">
          <em>None</em>
        </MenuItem>
        <MenuItem value={10}>Ten</MenuItem>
        <MenuItem value={20}>Twenty</MenuItem>
        <MenuItem value={30}>Thirty</MenuItem>
      </Select>
      <FormHelperText>Some important helper text</FormHelperText>
    </FormControl>
  </Story>
  <Story name="without label">
    <FormControl m={2} minWidth={300}>
      <Select onChange={action('change')} displayEmpty name="age">
        <MenuItem value="">
          <em>None</em>
        </MenuItem>
        <MenuItem value={10}>Ten</MenuItem>
        <MenuItem value={20}>Twenty</MenuItem>
        <MenuItem value={30}>Thirty</MenuItem>
      </Select>
      <FormHelperText>Without label</FormHelperText>
    </FormControl>
  </Story>
  <Story name="label+placeholder">
    <FormControl m={2} minWidth={300}>
      <InputLabel shrink htmlFor="age-label-placeholder">
        Age
      </InputLabel>
      <Select
        onChange={action('change')}
        input={<OutlinedInput name="age" id="age-label-placeholder" />}
        displayEmpty
        name="age"
      >
        <MenuItem value="">
          <em>None</em>
        </MenuItem>
        <MenuItem value={10}>Ten</MenuItem>
        <MenuItem value={20}>Twenty</MenuItem>
        <MenuItem value={30}>Thirty</MenuItem>
      </Select>
      <FormHelperText>Label + placeholder</FormHelperText>
    </FormControl>
  </Story>
  <Story name="disabled">
    <FormControl disabled m={2} minWidth={300}>
      <InputLabel htmlFor="name-disabled">Name</InputLabel>
      <Select
        onChange={action('change')}
        input={<OutlinedInput name="name" id="name-disabled" />}
      >
        <MenuItem value="">
          <em>None</em>
        </MenuItem>
        <MenuItem value="hai">Hai</MenuItem>
        <MenuItem value="olivier">Olivier</MenuItem>
        <MenuItem value="kevin">Kevin</MenuItem>
      </Select>
      <FormHelperText>Disabled</FormHelperText>
    </FormControl>
  </Story>
  <Story name="error">
    <FormControl error m={2} minWidth={300}>
      <InputLabel htmlFor="name-error">Name</InputLabel>
      <Select
        onChange={action('change')}
        name="name"
        renderValue={value => `⚠️ - ${value}`}
        input={<OutlinedInput id="name-error" />}
      >
        <MenuItem value="">
          <em>None</em>
        </MenuItem>
        <MenuItem value="hai">Hai</MenuItem>
        <MenuItem value="olivier">Olivier</MenuItem>
        <MenuItem value="kevin">Kevin</MenuItem>
      </Select>
      <FormHelperText>Error</FormHelperText>
    </FormControl>
  </Story>
  <Story name="read-only">
    <FormControl m={2} minWidth={300}>
      <InputLabel htmlFor="name-readonly">Name</InputLabel>
      <Select
        onChange={action('change')}
        input={<OutlinedInput name="name" id="name-readonly" readOnly />}
      >
        <MenuItem value="">
          <em>None</em>
        </MenuItem>
        <MenuItem value="hai">Hai</MenuItem>
        <MenuItem value="olivier">Olivier</MenuItem>
        <MenuItem value="kevin">Kevin</MenuItem>
      </Select>
      <FormHelperText>Read only</FormHelperText>
    </FormControl>
  </Story>
  <Story name="auto width">
    <FormControl m={2} minWidth={300}>
      <InputLabel htmlFor="age-auto-width">Age</InputLabel>
      <Select
        onChange={action('change')}
        input={<OutlinedInput name="age" id="age-auto-width" />}
        autoWidth
      >
        <MenuItem value="">
          <em>None</em>
        </MenuItem>
        <MenuItem value={10}>Ten</MenuItem>
        <MenuItem value={20}>Twenty</MenuItem>
        <MenuItem value={30}>Thirty</MenuItem>
      </Select>
      <FormHelperText>Auto width</FormHelperText>
    </FormControl>
  </Story>
  <Story name="display empty">
    <FormControl m={2} minWidth={300}>
      <Select onChange={action('change')} name="age" displayEmpty>
        <MenuItem value="" disabled>
          Placeholder
        </MenuItem>
        <MenuItem value={10}>Ten</MenuItem>
        <MenuItem value={20}>Twenty</MenuItem>
        <MenuItem value={30}>Thirty</MenuItem>
      </Select>
      <FormHelperText>Placeholder</FormHelperText>
    </FormControl>
  </Story>
  <Story name="required">
    <FormControl required m={2} minWidth={300}>
      <InputLabel htmlFor="age-required">Age</InputLabel>
      <Select
        onChange={action('change')}
        name="age"
        inputProps={{
          id: 'age-required'
        }}
      >
        <MenuItem value="">
          <em>None</em>
        </MenuItem>
        <MenuItem value={10}>Ten</MenuItem>
        <MenuItem value={20}>Twenty</MenuItem>
        <MenuItem value={30}>Thirty</MenuItem>
      </Select>
      <FormHelperText>Required</FormHelperText>
    </FormControl>
  </Story>
  <Story name="standard">
    <FormControl variant="standard" m={2} minWidth={300}>
      <InputLabel htmlFor="age-simple">Age</InputLabel>
      <Select
        onChange={action('change')}
        input={<Input name="age" id="age-simple" />}
      >
        <MenuItem value="">
          <em>None</em>
        </MenuItem>
        <MenuItem value={10}>Ten</MenuItem>
        <MenuItem value={20}>Twenty</MenuItem>
        <MenuItem value={30}>Thirty</MenuItem>
      </Select>
    </FormControl>
  </Story>
</Preview>

## With state

<Preview>
  <Story name="with state">
    {React.createElement(() => {
      const [values, setValues] = React.useState({
        age: '',
        name: 'hai'
      })
      const inputLabel = React.useRef(null)
      const [labelWidth, setLabelWidth] = React.useState(0)
      function handleChange(event) {
        setValues(oldValues => ({
          ...oldValues,
          [event.target.name]: event.target.value
        }))
      }
      return (
        <Form autoComplete="off">
          <Flex flexDirection="column">
            <FormControl m={2} mt={3} minWidth={300}>
              <InputLabel ref={inputLabel} htmlFor="age-simple">
                Age
              </InputLabel>
              <Select
                labelWidth={labelWidth}
                value={values.age}
                onChange={handleChange}
                inputProps={{ name: 'age', id: 'age-simple' }}
              >
                <MenuItem value={10}>Ten</MenuItem>
                <MenuItem value={20}>Twenty</MenuItem>
                <MenuItem value={30}>Thirty</MenuItem>
              </Select>
            </FormControl>
            <FormControl m={2} mt={3} minWidth={300}>
              <InputLabel htmlFor="age-helper">Age</InputLabel>
              <Select
                value={values.age}
                onChange={handleChange}
                input={<OutlinedInput name="age" id="age-helper" />}
              >
                <MenuItem value="">
                  <em>None</em>
                </MenuItem>
                <MenuItem value={10}>Ten</MenuItem>
                <MenuItem value={20}>Twenty</MenuItem>
                <MenuItem value={30}>Thirty</MenuItem>
              </Select>
              <FormHelperText>Some important helper text</FormHelperText>
            </FormControl>
            <FormControl m={2} mt={4} minWidth={300}>
              <Select
                value={values.age}
                onChange={handleChange}
                displayEmpty
                name="age"
              >
                <MenuItem value="">
                  <em>None</em>
                </MenuItem>
                <MenuItem value={10}>Ten</MenuItem>
                <MenuItem value={20}>Twenty</MenuItem>
                <MenuItem value={30}>Thirty</MenuItem>
              </Select>
              <FormHelperText>Without label</FormHelperText>
            </FormControl>
            <FormControl m={2} mt={4} minWidth={300}>
              <InputLabel shrink htmlFor="age-label-placeholder">
                Age
              </InputLabel>
              <Select
                value={values.age}
                onChange={handleChange}
                input={<OutlinedInput name="age" id="age-label-placeholder" />}
                displayEmpty
                name="age"
              >
                <MenuItem value="">
                  <em>None</em>
                </MenuItem>
                <MenuItem value={10}>Ten</MenuItem>
                <MenuItem value={20}>Twenty</MenuItem>
                <MenuItem value={30}>Thirty</MenuItem>
              </Select>
              <FormHelperText>Label + placeholder</FormHelperText>
            </FormControl>
            <FormControl m={2} mt={4} minWidth={300} disabled>
              <InputLabel htmlFor="name-disabled">Name</InputLabel>
              <Select
                value={values.name}
                onChange={handleChange}
                input={<OutlinedInput name="name" id="name-disabled" />}
              >
                <MenuItem value="">
                  <em>None</em>
                </MenuItem>
                <MenuItem value="hai">Hai</MenuItem>
                <MenuItem value="olivier">Olivier</MenuItem>
                <MenuItem value="kevin">Kevin</MenuItem>
              </Select>
              <FormHelperText>Disabled</FormHelperText>
            </FormControl>
            <FormControl m={2} mt={4} minWidth={300} error>
              <InputLabel htmlFor="name-error">Name</InputLabel>
              <Select
                value={values.name}
                onChange={handleChange}
                name="name"
                renderValue={value => `⚠️ - ${value}`}
                input={<OutlinedInput id="name-error" />}
              >
                <MenuItem value="">
                  <em>None</em>
                </MenuItem>
                <MenuItem value="hai">Hai</MenuItem>
                <MenuItem value="olivier">Olivier</MenuItem>
                <MenuItem value="kevin">Kevin</MenuItem>
              </Select>
              <FormHelperText>Error</FormHelperText>
            </FormControl>
            <FormControl m={2} mt={4} minWidth={300}>
              <InputLabel htmlFor="name-readonly">Name</InputLabel>
              <Select
                value={values.name}
                onChange={handleChange}
                input={
                  <OutlinedInput name="name" id="name-readonly" readOnly />
                }
              >
                <MenuItem value="">
                  <em>None</em>
                </MenuItem>
                <MenuItem value="hai">Hai</MenuItem>
                <MenuItem value="olivier">Olivier</MenuItem>
                <MenuItem value="kevin">Kevin</MenuItem>
              </Select>
              <FormHelperText>Read only</FormHelperText>
            </FormControl>
            <FormControl m={2} mt={4} minWidth={300}>
              <InputLabel htmlFor="age-auto-width">Age</InputLabel>
              <Select
                value={values.age}
                onChange={handleChange}
                input={<OutlinedInput name="age" id="age-auto-width" />}
                autoWidth
              >
                <MenuItem value="">
                  <em>None</em>
                </MenuItem>
                <MenuItem value={10}>Ten</MenuItem>
                <MenuItem value={20}>Twenty</MenuItem>
                <MenuItem value={30}>Thirty</MenuItem>
              </Select>
              <FormHelperText>Auto width</FormHelperText>
            </FormControl>
            <FormControl m={2} mt={4} minWidth={300}>
              <Select
                value={values.age}
                onChange={handleChange}
                name="age"
                displayEmpty
              >
                <MenuItem value="" disabled>
                  Placeholder
                </MenuItem>
                <MenuItem value={10}>Ten</MenuItem>
                <MenuItem value={20}>Twenty</MenuItem>
                <MenuItem value={30}>Thirty</MenuItem>
              </Select>
              <FormHelperText>Placeholder</FormHelperText>
            </FormControl>
            <FormControl m={2} mt={4} minWidth={300} required>
              <InputLabel htmlFor="age-required">Age</InputLabel>
              <Select
                value={values.age}
                onChange={handleChange}
                name="age"
                inputProps={{
                  id: 'age-required'
                }}
              >
                <MenuItem value="">
                  <em>None</em>
                </MenuItem>
                <MenuItem value={10}>Ten</MenuItem>
                <MenuItem value={20}>Twenty</MenuItem>
                <MenuItem value={30}>Thirty</MenuItem>
              </Select>
              <FormHelperText>Required</FormHelperText>
            </FormControl>
            <FormControl m={2} mt={4} minWidth={300}>
              <InputLabel ref={inputLabel} htmlFor="outlined-age-simple">
                Age
              </InputLabel>
              <Select
                value={values.age}
                onChange={handleChange}
                input={<OutlinedInput name="age" id="outlined-age-simple" />}
              >
                <MenuItem value="">
                  <em>None</em>
                </MenuItem>
                <MenuItem value={10}>Ten</MenuItem>
                <MenuItem value={20}>Twenty</MenuItem>
                <MenuItem value={30}>Thirty</MenuItem>
              </Select>
            </FormControl>
          </Flex>
        </Form>
      )
    })}
  </Story>
</Preview>

## Props

<Props of={SelectDocs} />
